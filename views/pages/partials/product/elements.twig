{#
| Variable                                        | Type                       | Description                                                                                    |
|-------------------------------------------------|----------------------------|------------------------------------------------------------------------------------------------|
| product.options                                 | ?ProductOption *Collection |                                                                                                |
| product.options[].id                            | int                        |                                                                                                |
| product.options[].name                          | string                     |                                                                                                |
| product.options[].required                      | bool                       |                                                                                                |
| product.options[].type                          | string                     | radio, date, datetime, time, image, text, textarea, number, checkbox, splitter                 |
| product.options[].placeholder                   | ?string                    |                                                                                                |
| product.options[].option_type                   | ?string                    | color, image, text                                                                             |
| product.options[].not_same_day_order            | bool                       |                                                                                                |
| product.options[].availability_range            | bool                       |                                                                                                |
| product.options[].from_date_time                | ?string                    | Date, ex: `2021-12-21 21:21:21`                                                                |
| product.options[].to_date_time                  | ?string                    | Date, ex: `2021-12-21 21:21:21`                                                                |
| product.options[].visibility_condition          | ?object                    |                                                                                                |
| product.options[].visibility_condition.option   | int                        | An id of another option from the types (`checkbox`, `radio`)                                   |
| product.options[].visibility_condition.operator | string                     | `=` or `!=`                                                                                    |
| product.options[].visibility_condition.value    | int                        | An id of optionDetail                                                                          |
| product.options[].element                       | string                     | Html content from files `views/components/product/elements/*.twig`                             |
| product.options[].details                       | OptionDetail *Collection   |                                                                                                |
| product.options[].details[].id                  | int                        |                                                                                                |
| product.options[].details[].name                | string                     | Name only ex `Red`                                                                             |
| product.options[].details[].full_name           | string                     | Includes name, additional price, and outOfStock ex `Red (+100SAR) - Out Of Stock`              |
| product.options[].details[].additional_price    | float                      | ex: `100`                                                                                      |
| product.options[].details[].option_value        | ?string                    | The value of `product.options[].option_type`, hexColor or image url for types `color`, `image` |
| product.options[].details[].image               | ?string                    | An alias for `.option_value`, should be use when `product.options[].option_type` = `image`     |
| product.options[].details[].color               | ?string                    | Hex Color, should be use when `product.options[].option_type` = `color`                        |
| product.options[].details[].is_selected         | bool                       | Does current option selected? (useful in cart page)                                            |
| product.options[].details[].is_out              | bool                       | Does current option out of stock?                                                              |
#}
{% if product.is_donation %}
    <div id="cart_donating_form">
        {% component 'product.donation-progress-bar' with {product:product} %}
        <div class="product-section product-section--has-label">
            <div>
                <label>{{ trans('pages.products.donation_amount') }}</label>
            </div>
            <div class="form-group">
                {% if product.can_donate %}
                    {{ csrf_field() }}
                    <div class="input-group input-group--end">
                        <input placeholder="{{ trans('pages.products.donation_placeholder') }}"
                               type="text"
                               id="donating_amount"
                               name="{{ is_cart?'amount_donating':'donating_amount' }}"
                               class="form-control _parseArabicNumbers"
                               value="{{ is_cart?product.price:'' }}"
                               data-digits-with-decimal
                               data-digits/>
                        <span class="input-group-addon"> {{ currency }} </span>
                    </div>
                {% else %}
                    <h4 class="d-block wide font-xsm color-danger">
                        {% if product.donation.completed %}
                            {{ trans('pages.products.donation_exceed_target_amount') }}
                        {% else %}
                            {{ trans('pages.products.donation_exceed_target_date') }}
                        {% endif %}
                    </h4>
                {% endif %}
            </div>
        </div>
    </div>
{% else%}
    <section class="bg-white p-5 rounded-md mb-5">
        {% for option_index, option in product.options %}
            {% if option.type == "splitter" %}
                <div class="product-section splitter"></div>
            {% else %}
                <div class="{{ option.visibility_condition?'hidden':'' }}" {{ option.condition_attributes|raw }}>
                    <div class="sm:grid sm:grid-cols-3 sm:gap-4 sm:items-start mb-5">
                        <label for="options[{{ option.id }}]" class="form-label">
                            <b class="block">
                                {{ option.name }}
                                {% if option.required %}<span class="text-red-500">*</span>{% endif %}
                            </b>
                            <small class="text-gray-text">{{ option.placeholder }}</small>
                        </label>
                        <div class="mt-1 sm:mt-0 sm:col-span-2">
                            {{ option.element|raw }}
                        </div>
                    </div>
                </div>
            {% endif %}
        {% endfor %}
    </section>
{% endif %}

{% if product.can_add_note or product.can_upload_file %}
    <section class="bg-white p-5 rounded-md mb-5">
        <div class="sm:grid sm:grid-cols-3 sm:gap-4 sm:items-start">
            <label class="form-label">
                <b class="block">
                    {{ trans('pages.products.attachments') }}
                </b>
            </label>
            <div class="mt-1 sm:mt-0 sm:col-span-2 text-end"
                 x-data="{ tab: '{{ product.notes ? "showNote": (product.attachments|length ? "showUpload":"") }}' }">
                <div class="flex space-s-3">
                    {% if product.can_add_note %}
                        <button type="button" @click="tab = 'showNote'" data-show="#note_{{ product.id }}"
                                class="w-full focus:outline-none  bg-gray-bg  py-2.5 xs:ps-7 xs:pe-5 rounded-md flex items-center text-gray-500 justify-center text-sm">
                            <i class="font-medium sicon-chat-conversation-alt me-1.5 text-md"></i>
                            <span class="fix-align">{{ trans('pages.products.add_note') }} </span>
                        </button>
                    {% endif %}
                    {% if product.can_upload_file %}
                        <button @click="tab = 'showUpload' " type="button" data-show="#upload_file_{{ product.id }}"
                                class="w-full  focus:outline-none bg-gray-bg  py-2.5 xs:ps-7 xs:pe-5 rounded-md flex items-center text-gray-500 justify-center text-sm">
                            <i class="font-medium sicon-paperclip me-1.5 text-md"></i>
                            <span class="fix-align">{{ trans('pages.products.add_file') }}</span>
                        </button>
                    {% endif %}
                </div>

                {% if product.can_add_note %}
                    <div class="mt-4" x-show="tab === 'showNote'" data-show-content
                         id="note_{{ product.id }}">
                            <textarea placeholder="{{ trans('pages.products.notes_placeholder') }}"
                                      name="notes"
                                      class="animated animatedfadeInDown fadeInDown form-input h-16 bg-coolGray-50 block"
                                      cols="30" rows="10">{{ product.notes }}</textarea>
                    </div>
                {% endif %}
                {% if product.can_upload_file %}
                    <div x-show="tab === 'showUpload'" class="mt-4">

                        <div class="animated animatedfadeInDown fadeInDown">
                            <input type="file"
                                   class="filepond form-control filepond--product-option"
                                   id="attached_file_{{ product.id }}"
                                   name="{{ is_cart?'image_file':'file' }}"
                                    {% if is_cart %}
                                        {# "product" here is actually cart.items[*], so {product.id} is {item.id} #}
                                        data-url="{{ link('cart/image') }}"
                                        data-instant-upload
                                        data-files="{{ product.attachments }}"
                                        data-item-id="{{ product.id }}"
                                        data-product-id="{{ product.product_id }}"
                                    {% endif %}
                                   data-max-file-size="3MB"
                            />
                        </div>
                    </div>
                {% endif %}
            </div>
        </div>
    </section>
{% endif %}
