{% if is_mobile %}
    <li class="text-sm font-bold" {{ menu.attrs }}>
        {% if not menu.has_children %}
            <a {{ menu.link_attrs }} href="{{ menu.url }}" class="text-gray-500">{{ menu.title }}</a>
        {% else %}
            <span>{{ menu.title }}</span>
            <ul>
                <li class="text-sm font-bold"><a href="{{ menu.url }}" class="text-gray-500">{{ menu.title }}</a></li>
                {% for submenu in menu.children %}
                    {% include _self with {menu:submenu} %}
                {% endfor %}
            </ul>
        {% endif %}
    </li>
{% else %}
    <li class="{{ is_root_menu?'root-level':'relative' }}
        {{ menu.mega_menu?' mega-menu': '' }}
        {{ menu.has_children?' has-children': '' }}"
        {{ menu.attrs|raw }}>
        {# TODO:: collect these classes in short class#}
        <a href="{{ menu.url }}">
            <span>{{ menu.title }}</span>
        </a>
        {% if menu.has_children %}
            <div class="sub-menu {{ menu.mega_menu?'w-full left-0 flex': 'w-56 pb-2' }}">
                <ul class="{{ menu.mega_menu?'w-56 flex-shrink-0 m-8 me-0': '' }}">
                    {% for submenu in menu.children %}
                        {% include _self with {menu:submenu, is_root_menu:false} %}
                    {% endfor %}
                </ul>
                {% if menu.mega_menu %}
                    <div class="flex-grow-1 p-8">
                        <div class="grid gap-4 grid-cols-4">
                            {% for product in menu.mega_menu|slice(0, 4) %}
                                {% include 'pages.partials.product.card' with {block_classes:'shadow-default'} %}
                            {% endfor %}
                        </div>
                    </div>
                {% endif %}

            </div>
        {% endif %}
    </li>
{% endif %}
