<div class="row">
    <div class="col-md-12">
        <div class="comments comments--product mt-50 mb-0">
            {% if can_comment %}
                <div class="form form--add-comment" salla-form-data>
                    {% honeypot %}
                    <div class="comment-field-wrapper">
                        <div class="avatar-wrapper avatar-wrapper--small avatar-wrapper--circular avatar-wrapper--bordered mr-4">
                            <img class="lazy-load" data-src="{{ user.avatar?:asset('images/avatar_male.png')}}" alt="user avatar">
                        </div>
                        <div>
                            <div class="form-group">
                                <textarea placeholder="{{ trans('blocks.comments.placeholder') }}"
                                        class="form-control"
                                        name="ask_textarea"
                                        maxlength="500"></textarea>
                            </div>
                            <div class="form-group mb-0">
                                <a class="btn btn--oval btn--wide btn--padded btn--large btn--primary"
                                   data-on-click="comment-product-add"
                                   id="add-new-comment-btn"
                                   data-id="{{ id }}"
                                   href="#">

                                    <div class="line-scale">
                                        <div></div>
                                        <div></div>
                                        <div></div>
                                        <div></div>
                                        <div></div>
                                    </div>

                                    <span class="btn__text">{{ trans('blocks.comments.submit') }}</span>
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            {% endif %}
            {% if comments is not empty %}
                <div class="view-comment comments-container">
                    <div class="comments-title">{{ pluralize('blocks.comments.comment', total_comments)|raw }} </div>
                    {% for comment in comments %}
                        {% include 'pages.partials.single-comment' %}
                    {% endfor %}
                </div>
                {% include 'pages.partials.loader-status' with {'nextPageUrl':comments.nextPageUrl} %}

            {% endif %}
        </div>
    </div>
</div>

<script>
{# ADD Comment Validations & Loading #}
var add_btn = document.getElementById('add-new-comment-btn'),
    ask_textarea = document.querySelector('textarea[name="ask_textarea"]');

if (add_btn) {
  add_btn.addEventListener('click', function(){
    if(ask_textarea.value !== '' && ask_textarea.value.length >= 3 ){
      add_btn.classList.add('btn--has-loading');
      add_btn.setAttribute('disabled',true);
    }
    else {
      ask_textarea.parentElement.classList.add('error');
    }
  })
}

if (ask_textarea) {
  ask_textarea.addEventListener('keyup', function(){
    ask_textarea.parentElement.classList.remove('error');
  });
}
</script>