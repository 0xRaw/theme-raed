(()=>{"use strict";function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t(e)}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function a(e,t){return a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},a(e,t)}function o(e,r){if(r&&("object"===t(r)||"function"==typeof r))return r;if(void 0!==r)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function i(e){return i=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},i(e)}new(function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&a(e,t)}(f,e);var t,l,c,u,s=(c=f,u=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=i(c);if(u){var r=i(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return o(this,e)});function f(){return r(this,f),s.apply(this,arguments)}return t=f,(l=[{key:"onReady",value:function(){var e=this;this.highlightSelectedStars(),this.starsRating(),document.querySelector("#submitRating").addEventListener("click",(function(){return e.sendRating()}))}},{key:"sendRating",value:function(){var e=this;this.ratingValidation(),document.querySelectorAll(".rating-section").forEach((function(t){var r=t.dataset.type,n=[];t.querySelectorAll(".rating-outer-form").forEach((function(t){var a={};t.querySelectorAll("[name]").forEach((function(e){var t=salla.helpers.inputData(e.name,e.value,a);a[t.name]=t.value})),(n=[]).push(a),e.sendFeedback(r,n)}))}))}},{key:"sendFeedback",value:function(e,t){t&&0!=t.length&&(salla.config.canLeave=!1,salla.feedback.api[e](t[0]).then((function(){salla.config.canLeave=!0})).catch((function(e){return salla.config.canLeave=!0})))}},{key:"ratingValidation",value:function(){var e="";if(document.querySelectorAll(".rating-section").forEach((function(t){t.querySelectorAll(".rating-outer-form").forEach((function(t){var r=t.querySelector(".rating_hidden_input"),n=t.querySelector(".comment"),a=t.querySelector(".section-title"),o=t.querySelector(".validation-message");if(r.value&&n.value&&n.value.length>3)return n.classList.remove("has-error"),a.classList.remove("has-error","text-red-400"),void(o.innerHTML="");n.value&&n.value.length>3?n.classList.remove("has-error"):n.classList.add("has-error"),a.classList.add("has-error","text-red-400"),e=r.value?salla.lang.get("common.errors.not_less_than_chars",{chars:4})+" "+n.getAttribute("placeholder"):t.dataset.starsError||salla.lang.get("pages.rating.rate_store_stars"),o.innerHTML=e}));var r=document.querySelectorAll(".has-error");if(r.length){var n=r[0].offsetTop;window.scrollTo({top:n-80})}})),e)throw new Error(e)}},{key:"highlightSelectedStars",value:function(){var e=["hovered","text-theme-yellow"];document.querySelectorAll(".rate-element").forEach((function(t){var r=t.querySelectorAll(".btn--star");t.addEventListener("mouseout",(function(){t.querySelectorAll(".btn--star").forEach((function(t){var r;(r=t.classList).remove.apply(r,e)}))})),r.forEach((function(t,n){t.addEventListener("mouseover",(function(){var a,o;if((a=t.classList).add.apply(a,e),n<=1)"BUTTON"===t.previousElementSibling.tagName&&(o=t.previousElementSibling.classList).add.apply(o,e);else for(var i=0;i<n;i++){var l;(l=r[i].classList).add.apply(l,e)}})),t.addEventListener("mouseout",(function(){var r,n;(r=t.classList).contains.apply(r,e)&&(n=t.classList).remove.apply(n,e)}))}))}))}},{key:"starsRating",value:function(){var e=["selected","text-theme-yellow"];salla.document.event.onSubmit(".rate-element",(function(t){t.preventDefault();var r=t.target.querySelectorAll(".btn--star.hovered"),n=r[r.length-1];if(n){var a=parseInt(n.dataset.star,10),o=n.dataset.text;t.target.nextElementSibling.innerHTML=o,t.target.querySelector(".rating_hidden_input").value=a,t.target.querySelectorAll(".btn--star").forEach((function(t,r){var n,o;r<a?(o=t.classList).add.apply(o,e):(n=t.classList).remove.apply(n,e)}));var i=t.target.querySelector('.star[aria-pressed="true"]');i&&i.removeAttribute("aria-pressed"),n.setAttribute("aria-pressed",!0)}}))}}])&&n(t.prototype,l),f}(function(){function t(){var e=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),window.page=this,document.addEventListener("DOMContentLoaded",(function(){return e.loadApp().then((function(){return e.onReady()||e.registerEvents()||app.log("Page Class LoadedðŸŽ‰")}))}))}var r,n;return r=t,(n=[{key:"loadApp",value:function(){var e,t=0;return new Promise((function(r,n){return e=setInterval((function(){window.app&&window.app.isThemeApp&&(app.log("Loading Page Class..."),r(!0),clearInterval(e)),t>10&&(n("Failed to Find `window.app`ðŸ˜¢"),clearInterval(e)),t++}),100)}))}},{key:"onReady",value:function(){}},{key:"registerEvents",value:function(){}}])&&e(r.prototype,n),t}()))})();