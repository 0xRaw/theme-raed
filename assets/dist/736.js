"use strict";(self.webpackChunkTheme_One=self.webpackChunkTheme_One||[]).push([[736],{736:(e,s,t)=>{t.r(s),t.d(s,{salla_offer:()=>a});var r=t(378),o=t(863);const a=class{constructor(e){var s,t;(0,r.r)(this,e),this.offer=null,this.offer_expires_in=salla.lang.get("pages.products.offer_expires_in"),this.remember_my_choice=salla.lang.get("commone.remember_my_choice"),o.H.setHost(this.host),salla.event.on("languages::translations.loaded",(()=>{this.offer_expires_in=salla.lang.get("pages.products.offer_expires_in"),this.remember_my_choice=salla.lang.get("common.remember_my_choice")})),this.categorySlot=(null===(s=o.H.getElement('[slot="category"]'))||void 0===s?void 0:s.innerHTML)||'<i class="s-offer-badge-icon sicon-tag"></i><span class="s-offer-badge-text">{name}</span>',this.productSlot=(null===(t=o.H.getElement('[slot="product"]'))||void 0===t?void 0:t.innerHTML)||this.defaultProductSlot(),salla.offer.event.onExisted((e=>{salla.localData.get("remember-offer-"+e.offer.offer_id)?salla.log("User selected to don't show this offer again."):this.show(e.product_id)}))}async show(e){return salla.api.offer.details(e).then((e=>this.showOffer(e.data[0])))}async showOffer(e){return this.offer=e,this.offer_name=e.name,this.offer_message=e.message,this.modal.show()}rememberMe(e){salla.localData.set("remember-offer-"+this.offer.id,e.target.checked)}addItem(){return this.load(),salla.cart.api.quickAdd(this.dataset.id).finally((()=>this.stop()))}defaultProductSlot(){return'<a href={url} class="s-offer-product-image-wrap"><img class="s-offer-product-image" src="{image}" /></a><div class="s-offer-product-info">   <a href={url} class="s-offer-product-name">{name}</a>   <div class="s-offer-product-price">{price}</div></div>'}render(){var e,s;return(0,r.h)("salla-modal",{"sub-title-first":!0,icon:"sicon-special-discount",title:"عروض رائعة في انتظارك، ماذا نتنظر!","sub-title":this.offer_message,ref:e=>this.modal=e,"is-loading":null===this.offer},null!==this.offer?[(0,r.h)("div",{class:"s-offer-scrolled-slider-wrap"},(0,r.h)("div",{class:"s-offer-body s-offer-scrolled-slider"},(null===(e=this.offer.get.categories)||void 0===e?void 0:e.length)>0?this.offer.get.categories.map((e=>(0,r.h)("a",{href:e.urls.customer,class:"s-offer-badge s-offer-slider-item",innerHTML:this.categorySlot.replace(/\{name\}/g,e.name).replace(/\{url\}/g,e.urls.customer)}))):null===(s=this.offer.get.products)||void 0===s?void 0:s.map((e=>(0,r.h)("div",{class:"s-offer-product s-offer-slider-item",id:"product_"+e.id,innerHTML:this.productSlot.replace(/\{name\}/g,e.name).replace(/\{url\}/g,e.url).replace(/\{image\}/g,e.thumbnail).replace(/\{price\}/g,e.has_special_price?salla.money(e.price)+'<span class="s-offer-product-old-price">'+salla.money(e.regular_price)+"</span>":salla.money({amount:e.price,currency:salla.config.get("user").currency_code}))},(0,r.h)("div",{class:"s-offer-btn-wrap"},(0,r.h)("salla-button",{wide:!0,"btn-style":"outline-primary","data-id":e.id,"loader-position":"center",onClick:this.addItem},salla.lang.get("pages.cart.add_to_cart"))))))),(0,r.h)("div",{class:"s-offer-slider-nav"},(0,r.h)("button",{class:"s-offer-nav-btn s-offer-prev-btn"},(0,r.h)("span",{class:"s-offer-nav-btn-icon sicon-keyboard_arrow_right"})),(0,r.h)("button",{class:"s-offer-nav-btn s-offer-next-btn"},(0,r.h)("span",{class:"s-offer-nav-btn-icon sicon-keyboard_arrow_left"})))),(0,r.h)("div",{class:"s-offer-footer",slot:"footer"},this.offer.expiry_date?(0,r.h)("p",{class:"s-offer-expiry"},this.offer_expires_in," ",this.offer.expiry_date):"",(0,r.h)("label",{class:"s-offer-remember-label"},(0,r.h)("input",{type:"checkbox",onChange:e=>this.rememberMe(e),class:"s-offer-remember-input"}),"  ",this.remember_my_choice))]:"")}componentDidRender(){if(this.modal.querySelectorAll("[hidden]").forEach((e=>e.removeAttribute("hidden"))),this.offer&&window.screen.width>639){let e=this.host.querySelector(".s-offer-scrolled-slider-wrap"),s=this.host.querySelector(".s-offer-scrolled-slider"),t=this.host.querySelectorAll(".s-offer-nav-btn"),r=this.host.querySelector(".s-offer-next-btn"),o=this.host.querySelector(".s-offer-prev-btn"),a=this.host.querySelectorAll(".s-offer-slider-item"),i=20,l=0,f=3,n=a[0].offsetWidth,c=a.length*n,d=e.offsetWidth,h=c-d,u=!!document.body.classList.contains("rtl");h>i&&r.classList.add("s-offer-btn-is-active"),window.onresize=function(){d=e.offsetWidth,h=c-d},s.addEventListener("scroll",(function(){let e=Math.abs(s.scrollLeft),t=h-i;e<=i?(r.classList.add("s-offer-btn-is-active"),o.classList.remove("s-offer-btn-is-active")):e<t?(r.classList.add("s-offer-btn-is-active"),o.classList.add("s-offer-btn-is-active")):e>=t&&(r.classList.remove("s-offer-btn-is-active"),o.classList.add("s-offer-btn-is-active"))})),t.forEach((e=>{e.addEventListener("click",(function(){e.classList.contains("s-offer-next-btn")?l++:l--,s.scrollTo({top:0,left:n*f*l*(u?-1:1),behavior:"smooth"})}))}))}}get host(){return(0,r.g)(this)}};a.style=".s-offer-body{-webkit-overflow-scrolling:touch}.s-offer-body::-webkit-scrollbar{display:none}.s-offer-next-btn{background:linear-gradient(90deg, #fff 25%, rgba(255, 255, 255, 0.4) 80%, rgba(255, 255, 255, 0) 100%)}.s-offer-prev-btn{background:linear-gradient(-90deg, #fff 25%, rgba(255, 255, 255, 0.4) 80%, rgba(255, 255, 255, 0) 100%)}"},863:(e,s,t)=>{t.d(s,{H:()=>o}),salla.event.setMaxListeners(20);class r extends salla.AppHelpers{setHost(e){this.host=e}getElement(e){return this.host.querySelector(e)}getAttribute(e,s){var t;return null===(t=this.getElement(e))||void 0===t?void 0:t.getAttribute(s)}val(e){return this.getAttribute(e,"value")}isUser(){return"user"===salla.config.get("user.type")}}const o=new r}}]);