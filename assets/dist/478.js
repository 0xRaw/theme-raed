"use strict";(self.webpackChunkTheme_One=self.webpackChunkTheme_One||[]).push([[478],{3698:(e,t,s)=>{s.d(t,{H:()=>a});class r extends salla.AppHelpers{setHost(e){this.host=e}getElement(e){return this.host.querySelector(e)}getAttribute(e,t){var s;return null===(s=this.getElement(e))||void 0===s?void 0:s.getAttribute(t)}val(e){return this.getAttribute(e,"value")}}const a=new r},5478:(e,t,s)=>{s.r(t),s.d(t,{order_rating:()=>i});var r=s(7502),a=s(3698);const i=class{constructor(e){(0,r.r)(this,e),this.stars=[1,2,3,4,5],this.order={shipping:{id:5622},order_id:"179794",products:[{title:"ساعة ذكية بنظام اندرويد",image:"https://salla-dev.s3.eu-central-1.amazonaws.com/Mvyk/T4kTqYNuPAZmPMLw1bx92RnjVMZyFszVXOUZQsFJ.jpg",price:"‏10,978.00 ر.س",qty:"‏2",totalBefore:"‏1120 ر.س",discount:"-5%",total:"‏1064 ر.س",id:"679822376",getOptimusRouteKey:"73233357"}],settings:{isProductsRating:!0,isStoreRating:!0,isShippingRating:!0}},this.ratingChain=Promise.resolve(),this.stepsCount=3,salla.event.on("order-rating::show",(()=>this.show()))}async show(){return this.modal.show()}async hide(){return this.modal.hide()}componentDidRender(){this.show(),this.initiateRating()}initiateRating(){this.highlightSelectedStars(),this.starsRating(),this.handleWizard(),salla.event.on("submit::order-rating",(()=>this.sendRating().then((()=>{a.H.toggle(".rating-wizard","hidden","is-closed",(()=>!0)),a.H.toggle(".thankyou-view","is-opened","hidden",(()=>!0))}))))}handleWizard(){let e=0,t=document.querySelectorAll(".step"),s=document.querySelectorAll(".step-dot");a.H.onClick("#prev-btn",(()=>{e>0&&e--,this.showActiveStep(t,s,e),0==e&&a.H.toggle("#prev-btn","hidden","block",(()=>!0))})),a.H.onClick("#next-btn",(()=>{this.ratingValidation(),e==this.stepsCount-1&&salla.event.dispatch("submit::order-rating"),e<this.stepsCount-1&&e++,this.showActiveStep(t,s,e),a.H.toggle("#prev-btn","block","hidden",(()=>!0))}))}showActiveStep(e,t,s){a.H.toggle(".step","hidden","active",(()=>!0)),a.H.toggle(".step-dot","bg-gray-200","bg-primay",(()=>!0)),a.H.toggleElement(e[s],"active","hidden",(()=>!0)),a.H.toggleElement(t[s],"bg-primary","bg-gray-200",(()=>!0))}sendRating(){return a.H.all(".rating-section",(e=>{let t=e.dataset.type,s=[];e.querySelectorAll(".rating-outer-form").forEach((e=>{let r={};e.querySelectorAll("[name]").forEach((function(e){let t=salla.helpers.inputData(e.name,e.value,r);r[t.name]=t.value})),s=[],s.push(r),this.sendFeedback(t,s)}))})),this.ratingChain}sendFeedback(e,t){t&&0!=t.length&&(salla.config.canLeave=!1,this.ratingChain=salla.feedback.api[e](t[0]).then((function(){salla.config.canLeave=!0})).catch((()=>salla.config.canLeave=!0)))}ratingValidation(){let e="";if(document.querySelectorAll(".rating-section.active").forEach((t=>{t.querySelectorAll(".rating-outer-form").forEach((t=>{let s=t.querySelector(".rating_hidden_input"),r=t.querySelector(".comment"),a=t.querySelector(".validation-message");if(s.value&&r.value&&r.value.length>3)return r.classList.remove("has-error"),void(a.innerHTML="");r.value&&r.value.length>3?r.classList.remove("has-error"):r.classList.add("has-error"),e=s.value?salla.lang.get("common.errors.not_less_than_chars",{chars:4})+" "+r.getAttribute("placeholder"):t.dataset.starsError||salla.lang.get("pages.rating.rate_store_stars"),a.innerHTML=e}))})),e){let t=document.querySelectorAll(".has-error");if(t.length){let e=t[0].offsetTop;window.scrollTo({top:e-80})}throw new Error(e)}}starsRating(){let e=["selected","text-theme-yellow"];salla.document.event.onSubmit(".rate-element",(function(t){t.preventDefault();var s=t.target.querySelectorAll(".btn--star.hovered"),r=s[s.length-1];if(r){var a=parseInt(r.dataset.star,10);t.target.querySelector(".rating_hidden_input").value=a,t.target.querySelectorAll(".btn--star").forEach((function(t,s){s<a?t.classList.add(...e):t.classList.remove(...e)}));var i=t.target.querySelector('.star[aria-pressed="true"]');i&&i.removeAttribute("aria-pressed"),r.setAttribute("aria-pressed",!0)}}))}highlightSelectedStars(){let e=["hovered","text-theme-yellow"];a.H.all(".rate-element",(t=>{let s=t.querySelectorAll(".btn--star");t.addEventListener("mouseout",(()=>t.querySelectorAll(".btn--star").forEach((t=>t.classList.remove(...e))))),s.forEach(((t,r)=>{t.addEventListener("mouseover",(()=>{if(t.classList.add(...e),r<=1)"BUTTON"===t.previousElementSibling.tagName&&t.previousElementSibling.classList.add(...e);else for(let t=0;t<r;t++)s[t].classList.add(...e)})),t.addEventListener("mouseout",(()=>{t.classList.contains(...e)&&t.classList.remove(...e)}))}))}))}render(){var e;return(0,r.h)("salla-modal",{id:"order-rating",class:"hidden","modal-width":"w-200",ref:e=>this.modal=e},(0,r.h)("slot",{name:"header"},(0,r.h)("div",{slot:"header",class:"font-bold text-lg"},"تقييم الطلب (#13259046)")),(0,r.h)("div",{class:"rating-wizard pannel__body transition-all"},this.order.settings.isStoreRating&&this.renderStoreRating(),this.order.settings.isProductsRating&&this.renderProductsRating(),this.order.settings.isShippingRating&&this.renderShippingRating()),this.renderThanksView(),(0,r.h)("slot",{name:"footer"},(0,r.h)("div",{slot:"footer",class:"pannel__footer relative flex justify-between items-center"},(0,r.h)("button",{id:"prev-btn",class:"font-bold text-sm text-primary hidden"},"السابق"),(0,r.h)("ul",{class:"flex justify-center text-center space-s-1.5 flex-1"},null===(e=[...Array(this.stepsCount)])||void 0===e?void 0:e.map(((e,t)=>(0,r.h)("li",{class:(0==t?"bg-primary":"bg-gray-200")+" step-dot cursor-pointer w-2.5 h-2.5  rounded-full transition-colors duration-300"})))),(0,r.h)("button",{id:"next-btn",class:"btn btn-primary h-10 px-8 flex-none"},"التالي"))))}renderStoreRating(){return(0,r.h)("section",{class:"step rating-section bg-white my-10 p-5 rounded-md mb-5 active","data-type":"store"},(0,r.h)("div",{class:"rating-outer-form text-center","data-stars-error":"يرجى تقييم المتجر بواسطة النجمات"},(0,r.h)("input",{type:"hidden",name:"order_id",value:this.order.order_id}),(0,r.h)("input",{type:"hidden",name:"type",value:"store"}),(0,r.h)("div",{class:"flex flex-col items-center "},(0,r.h)("div",{class:"w-28 h-28 border border-gray-200 rounded-full flex items-center justify-center mb-4"},(0,r.h)("img",{src:"https://salla-dev.s3.eu-central-1.amazonaws.com/Mvyk/X3NKcY7nhaFQlR7kBBHvfDpMY48cerunKrmDA1gi.png",alt:"store name",class:"w-12 object-contain"})),(0,r.h)("h2",{class:"section-title text-lg font-bold mb-7"},"كيف كانت تجربتك مع المتجر هذه المرة")),(0,r.h)("div",{class:"mb-2"},(0,r.h)("textarea",{id:"storeReview",name:"comment",class:"form-input comment h-20",placeholder:"اضف رأيك عن المتجر.."})),(0,r.h)("div",{class:"rating-wrap flex items-center space-s-4 flex justify-center"},(0,r.h)("form",{class:"rate-element rate-element--has-label"},this.getStarsRating())),(0,r.h)("small",{class:"text-red-400 validation-message"})))}renderProductsRating(){return(0,r.h)("section",{class:"step rating-section products-section hidden","data-type":"product"},(0,r.h)("div",{class:"bg-white mb-5 rounded-md overflow-hidden mb-10 pt-14"},this.order.products.map(((e,t)=>{var s;return(0,r.h)("div",{class:"rating-outer-form","data-stars-error":`يرجى تقييم (${e.title}) بواسطة النجمات`},(0,r.h)("div",{class:"product-item mb-4"},(0,r.h)("div",{class:"mb-5"},(0,r.h)("div",{class:"flex space-s-5 mb-8"},(0,r.h)("img",{src:e.image,alt:e.title,class:"w-18 h-14 object-cover rounded-md"}),(0,r.h)("div",{class:"flex-1"},(0,r.h)("h3",{class:"section-title leading-5 mb-1.5 font-bold  md:text-sm"}," ",e.title),(0,r.h)("div",{class:"rw-product-entry__rate"},(0,r.h)("div",{class:"rating-wrap flex items-center space-s-4"},(0,r.h)("form",{class:"rate-element rate-element--has-label"},this.getStarsRating())),(0,r.h)("input",{type:"hidden",name:"order_id",value:null===(s=this.order)||void 0===s?void 0:s.order_id}),(0,r.h)("input",{type:"hidden",name:`products[${t}][product_id]`,value:e.getOptimusRouteKey}),(0,r.h)("input",{type:"hidden",name:"type",value:"products"}),(0,r.h)("textarea",{"data-product-id":e.id,name:`products[${t}][comment]`,id:`productReview_${e.id}`,class:"comment form-input h-20 product-review",placeholder:`اضف رأيك عن المنتج (${e.title})`}),(0,r.h)("small",{class:"text-red-400 validation-message"})))))))}))))}renderShippingRating(){return(0,r.h)("section",{class:"step rating-section bg-white my-10 p-5 rounded-md mb-5 hidden","data-type":"shipping"},(0,r.h)("div",{class:"rating-outer-form text-center","data-stars-error":"يرجى تقييم شركة الشحن بواسطة النجمات"},(0,r.h)("input",{type:"hidden",name:"order_id",value:this.order.order_id}),(0,r.h)("input",{type:"hidden",name:"shipping_company_id",value:this.order.shipping.id}),(0,r.h)("input",{type:"hidden",name:"type",value:"shipping"}),(0,r.h)("div",{class:"flex flex-col items-center "},(0,r.h)("div",{class:"w-28 h-28 overflow-hidden border border-gray-200 rounded-full flex items-center justify-center mb-4"},(0,r.h)("img",{src:"https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcScPt4R6KaKDldrXb-9pUljFwL3m6A72BhN6p1qZJKprwC6VbCWC_8ASZgiJAoL_l7DepM&usqp=CAU",alt:"company name",class:"w-full h-full object-contain"})),(0,r.h)("h2",{class:"section-title text-lg font-bold mb-7"},"اخبرنا عن تجربتك مع شركة الشحن ارامكس")),(0,r.h)("div",{class:"mb-2"},(0,r.h)("textarea",{id:"shippingReview",name:"comment",class:"form-input comment h-20 mb-2",placeholder:"اضف رأيك عن شركة الشحن"})),(0,r.h)("div",{class:"rating-wrap flex items-center space-s-4 flex justify-center"},(0,r.h)("form",{class:"rate-element ratFeedbackPresentere-element--has-label"},this.getStarsRating())),(0,r.h)("small",{class:"text-red-400 validation-message"})))}renderThanksView(){return(0,r.h)("div",{class:"thankyou-view py-32 px-8 text-center hidden"},(0,r.h)("span",{class:"w-20 h-20 text-4xl inline-flex justify-center items-center bg-gray-50 rounded-full text-primary sicon-check-circle2"}),(0,r.h)("div",{class:"mt-4 mb-6"},(0,r.h)("h3",{class:"font-bold"},"تم تقييم الطلب بنجاح"),(0,r.h)("p",{class:"text-gray-400 text-sm"},"شكرا لتقييمك و مساعدتنا في تحسين تجربتنا لتقديم الأفضل لكم")),(0,r.h)("a",{href:"#!",onClick:()=>this.hide(),class:"btn btn-primary h-10 flex-none px-8"},"عودة إلي تفاصيل الطلب"))}getStarsRating(){return(0,r.h)("div",{class:"mb-1"},(0,r.h)("input",{type:"hidden",class:"rating_hidden_input",name:"rating",value:""}),this.stars.map((e=>(0,r.h)("button",{type:"submit",class:"btn btn--transparent px-1 text-2xl text-gray-400 btn--star","data-star":e},(0,r.h)("i",{class:"sicon-star2"})))))}get host(){return(0,r.g)(this)}};i.style=":host{display:block}"}}]);